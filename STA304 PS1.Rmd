---
title: "STA304 PS1"
author: "Liuxuan Wang"
date: "9/28/2020"
output: html_document
---

## Input data
```{r, echo = FALSE}

library(opendatatoronto)
library(dplyr)

# get package
package <- show_package("fc4d95a6-591f-411f-af17-327e6c5d03c7")
package

# get all resources for this package
resources <- list_package_resources("fc4d95a6-591f-411f-af17-327e6c5d03c7")

# identify datastore resources; by default, Toronto Open Data sets datastore resource format to CSV for non-geospatial and GeoJSON for geospatial resources
datastore_resources <- filter(resources, tolower(format) %in% c('csv', 'geojson'))

# load the first datastore resource as a sample
data <- filter(datastore_resources, row_number()==1) %>% get_resource()
data

```
## Description of dataset
### Background:
This dataset is about the neighbourhood crime data from 2014 to 2019. It includes the number of auto theft, assault, robbery, homicide, theft over and break and enter for each year. Also, based on the 2016 Census population, it includes five year averages and neighbourhood crime rates per 100,000 people.

### Description of variables:
_id: unique row identifier(int)
OBJECTID: Autogenerated distinct record identifier(int)
Neighbourhood: name of Toronto neighbourhood (chr)
Hood_ID: Toronto neighbourhood identifier (chr)
Population: 2016 Census population (int)
Assault_2014~Assault_2019: Count of assaults for 2014-2019(int)
Assault_AVG: Average Assaults from 2014 - 2019 (dbl)
Assault_CHG: Percantage change in assaults from 2018-2019(dbl)
Assault_Rate_2019: Rate of assaults for 2019 per 100,000 population (dbl)
AutoTheft_2014~AutoTheft_2019: Count of auto thefts for 2014 to 2019(int)
AutoTheft_AVG:Average auto thefts from 2014-2019 (dbl)
AutoTheft_CHG: Percentage Change in auto thefts from 2018-2019(dbl)
AutoTheft_Rate_2019: Rate of auto thefts for 2019 per 100,000 population(dbl)
BreakandEnter_2014~BreakandEnter_2019: Count of break and enters for 2014 to 2019 (int)
BreakandEnter_AVG: Average break and enters from 2014-2019 (dbl) BreakandEnter_CHG: percentage Change in break and enters from 2018-2019 (dbl)
BreakandEnter_Rate_2019: Rate of break and enters for 2019 per 100,000 population (dbl)
Homicide_2014~Homicide_2019: Count of homicides for 2014 to 2019 (int)
Robbery_AVG: Average robberies from 2014-2019 (dbl)
Robbery_CHG: percentage Change in robberies from 2018-2019 (dbl)
Robbery_Rate_2019: Rate of robberies for 2019 per 100,000 population (dbl)
TheftOver_2014~TheftOver_2019: Count of thefts over for 2014 to 2019 (int)
TheftOver_AVG: Average thefts over from 2014-2019 (dbl)
TheftOver_CHG: Percentage Change in thefts over from 2018-2019(dbl)
TheftOver_Rate_2019: Rate of thefts over for 2019 per 100,000 population (dbl)
Shape__Area: Autogenerated area measurement (dbl)
Shape__Length: Autogenerated length measurement (dbl)

# Category of data
```{r, echo = FALSE}
glimpse(data)
```
## Find something interesting with graphs
```{r, echo = FALSE}
# Histograms:
ggplot(data, aes(AutoTheft_2014, fill=AutoTheft_2014))+ geom_histogram(stat = "count", color = "pink", bins = 10)+labs(x = "Number of Auto Theft in 2014", y = "Frequency", title = "Histogram of number of Auto Theft in 2014", caption = "Source: Toronto Police Services")

ggplot(data, aes(AutoTheft_2015, fill=AutoTheft_2015))+ geom_histogram(stat = "count", color = "red", bins = 10)+labs(x = "Number of Auto Theft in 2015", y = "Frequency", title = "Histogram of number of Auto Theft in 2015", caption = "Source: Toronto Police Services")

ggplot(data, aes(AutoTheft_2016, fill=AutoTheft_2016))+ geom_histogram(stat = "count", color = "yellow", bins = 10)+labs(x = "Number of Auto Theft in 2016", y = "Frequency", title = "Histogram of number of Auto Theft in 2016", caption = "Source: Toronto Police Services")

ggplot(data, aes(AutoTheft_2017, fill=AutoTheft_2017))+ geom_histogram(stat = "count",color = "grey", bins = 10)+labs(x = "Number of Auto Theft in 2017", y = "Frequency", title = "Histogram of number of Auto Theft in 2017", caption = "Source: Toronto Police Services")

ggplot(data, aes(AutoTheft_2018, fill=AutoTheft_2018))+ geom_histogram(stat = "count", color = "blue", bins = 10)+labs(x = "Number of Auto Theft in 2018", y = "Frequency", title = "Histogram of number of Auto Theft in 2018", caption = "Source: Toronto Police Services")

ggplot(data, aes(AutoTheft_2019, fill=AutoTheft_2019))+ geom_histogram(stat = "count", color = "purple", bins = 10)+labs(x = "Number of Auto Theft in 2019", y = "Frequency", title = "Histogram of number of Auto Theft in 2019", caption = "Source: Toronto Police Services")
```

```{r, echo = FALSE}
# Boxplots:
year = c('2014', '2015', '2016', '2017', '2018', '2019')
number_of_autotheft = c(data$AutoTheft_2019, data$AutoTheft_2018, data$AutoTheft_2017, data$AutoTheft_2016, data$AutoTheft_2015, data$AutoTheft_2014)
autotheft_data = data.frame(year, number_of_autotheft)
ggplot(autotheft_data, aes(x = year, y = number_of_autotheft, fill = year )) + geom_boxplot(alpha = 0.3) + theme(legend.position = "none")+labs(x = "Year", y = "Number of Auto theft", title = "Boxplots of number of Auto Theft from 2019 to 2014", caption = "Source: Toronto Police Services")


```
## Discussion of graphs and findings

In this assignment, I mainly focus on exploring the situation of AutoTheft in Toronto Neighbourhood from 2014 to 2019.

Firstly, I draw a histogram of the number of Auto Theft for each year. The distributions of the number of Auto Theft for each year from 2014 to 2019 are very similar. It shows a skewness to the right. The maximum frequency often falls around 10 to 15. For year of 2015 and 2016, the shape of distribution come to be bimodal, the maximum frequency also falls around 20 to 25 except for the one we have mentioned. From the right side of each histograms, we can also see some data that could be outliers, which show extremely high quantity of auto thefts. In 2017, the number of neighbourhoods with more than 100 Auto Theft cases is 1, which is the least. In 2019, there are 5 neighbourhoods with more than 100 auto thefts, which is the most. For each year, there is a neighbourhood called West Humber-Clairville having around 300 AutoTheft cases, even close to 500 in 2019. 

Secondly, we put each year's Toronto neighbourhood auto theft data into boxplots to see the centre, spread and outliers.
